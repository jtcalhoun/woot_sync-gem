#  Copyright 2012 Taco Stadium LLC. All rights reserved.
#
#  All information contained herein, including documentation and any related
#  computer programs, is confidential, proprietary, and protected by trade
#  secret or copyright law. Use, reproduction, modification or transmission in
#  whole or in part in any form or by any means is prohibited without prior
#  written consent of Taco Stadium LLC.

this.WootSync = ((WootSync, $) ->
  ajaxSettings  =
    apiHost:   "<%= WootSync.config.client["api_host"] %>"
    siteHost:  "<%= WootSync.config.client["site_host"] %>",
    clientId:  undefined

  $.extend WootSync,
    ajax: (path = "", options = {}) ->
      $.ajax $.extend options,
        url:     ajaxSettings.apiHost + path,
        headers: ($.extend options.headers ? {}, {"X-Woot-Sync-Version": "<%= WootSync::VERSION::STRING %>"})
        data:    ($.extend options.data ? {}, {client_id: ajaxSettings.clientId})

    ajaxSetup: (settings = {}) ->
      ajaxSettings = $.extend settings, ajaxSettings
      return this

    getJSON: (path, data) ->
      return @ajax path,
        dataType: "json",
        data:     data

  return WootSync
) WootSync ? {}, jQuery
